# returning census data and geography for the Vancouver CMA as an sf-class dataframe
census_data <- get_census(dataset='CA21', regions=list(CMA="59933"), vectors=c("v_CA21_1","v_CA21_386","v_CA21_906","v_CA21_4238","v_CA21_4239", "v_CA21_4240", "v_CA21_4875", "v_CA21_4914"), labels="detailed", geo_format="sp", level='CT')
# returning census data and geography for the Vancouver CMA as an sf-class dataframe
census_data <- get_census(dataset='CA21', regions=list(CMA="59933"), vectors=c("v_CA21_1","v_CA21_386","v_CA21_906","v_CA21_4238","v_CA21_4239", "v_CA21_4240", "v_CA21_4875", "v_CA21_4914"), labels="detailed", geo_format="sp", level='CT')
class(census_data)
# obtaining centroids for census tracts in the Vancouver CMA
CT_centroids <- st_coordinates(st_centroid(census_data))
# returning census data and geography for the Vancouver CMA as an sf-class dataframe
census_data <- get_census(dataset='CA21', regions=list(CMA="59933"), vectors=c("v_CA21_1","v_CA21_386","v_CA21_906","v_CA21_4238","v_CA21_4239", "v_CA21_4240", "v_CA21_4875", "v_CA21_4914"), labels="detailed", geo_format="sf", level='CT')
class(census_data)
View(census_data)
View(centroids_df)
# obtaining centroids for census tracts in the Vancouver CMA
CT_centroids <- st_coordinates(st_centroid(census_data))
#converting centroids to data frame
centroids_df <- as.data.frame(CT_centroids)
class(centroids_df)
centroids_df<- rbind(centroids_df, census_data$GeoUID)
View(centroids_df)
# obtaining centroids for census tracts in the Vancouver CMA
CT_centroids <- st_coordinates(st_centroid(census_data))
#converting centroids to data frame
centroids_df <- as.data.frame(CT_centroids)
class(centroids_df)
centroids_df<- cbind(centroids_df, census_data$GeoUID)
# obtaining centroids for census tracts in the Vancouver CMA
CT_centroids <- st_coordinates(st_centroid(census_data))
#converting centroids to data frame
centroids_df <- as.data.frame(CT_centroids)
class(centroids_df)
centroids_df<- cbind(centroids_df, census_data$GeoUID)
centroids_df <- centroids_df %>%
rename("lat" = "X",
"lon" = "Y",
"id" = "census_data$GeoUID")
#building transport network for r5r
path <- file.path("Project data/r5rpath")
#building transport network for r5r
list.files(path)
r5r_core <- setup_r5(data_path = path)
#load origin points
points <- centroids_df
class(points)
#points of interest: parks
poi <- parks_coord
#departure times
departure_datetime <- as.POSIXct("13-05-2019 14:00:00",
format = "%d-%m-%Y %H:%M:%S")
access <- accessibility(r5r_core = r5r_core,
origins = points,
destinations = poi,
opportunities_colnames = c("schools", "healthcare"),
mode = c("WALK", "TRANSIT"),
departure_datetime = departure_datetime,
decay_function = "step",
cutoffs = 60
)
View(street_trees)
View(parks_coord)
View(parks)
#preparing park data for r5r
class(parks_coord)
##parks_df<- cbind(parks_coord, census_data$GeoUID)
#centroids_df <- centroids_df %>%
# rename("lat" = "X",
"lon" = "Y",
#preparing park data for r5r
class(parks_coord)
parks_coord<- cbind(parks_coord, parks$ParkID)
parks_coord <- parks_coord %>%
rename("lat" = "X",
"lon" = "Y",
"id" = "parks$ParkID")
#load origin points
points <- centroids_df
class(points)
#points of interest: parks
poi <- parks_coord
#departure times
departure_datetime <- as.POSIXct("13-05-2019 14:00:00",
format = "%d-%m-%Y %H:%M:%S")
access <- accessibility(r5r_core = r5r_core,
origins = points,
destinations = poi,
opportunities_colnames = c("schools", "healthcare"),
mode = c("WALK", "TRANSIT"),
departure_datetime = departure_datetime,
decay_function = "step",
cutoffs = 60
)
#preparing park data for r5r
class(parks_coord)
parks_coord<- cbind(parks_coord, parks$ParkID)
parks_coord <- parks_coord %>%
rename("lat" = "X",
"lon" = "Y",
"id" = "parks$ParkID")
#preparing park data for r5r
class(parks_coord)
parks_coord<- cbind(parks_coord, parks$ParkID)
parks_coord <- parks_coord %>%
rename("lat" = "X",
"lon" = "Y",
"id" = "parks$ParkID")
#preparing park data for r5r
class(parks_coord)
parks_coord<- cbind(parks_coord, parks$ParkID)
parks_coord <- parks_coord %>%
rename("lat" = "X",
"lon" = "Y",
"id" = "parks$ParkID")
#preparing park data for r5r
class(parks_coord)
parks_coord<- cbind(parks_coord, parks$ParkID)
parks_coord <- parks_coord %>%
rename("lat" = "X",
"lon" = "Y",
"id" = "parks$ParkID")
#preparing park data for r5r
class(parks_coord)
parks_coord<- cbind(parks_coord, parks$ParkID)
/# parks_coord <- parks_coord %>%
#preparing park data for r5r
class(parks_coord)
parks_coord<- cbind(parks_coord, parks$ParkID)
# parks_coord <- parks_coord %>%
## rename("lat" = "X",
##    "lon" = "Y",
##  "id" = "parks$ParkID")
parks_coord$lon <- as.numeric(parks_coord$lon)
knitr::opts_chunk$set(echo = TRUE)
summary(cars)
plot(pressure)
# loading packages
library(cancensus)
library(ggplot2)
library(tidyverse)
library(tidycensus)
library(tigris)
library(kableExtra)
library(plotly)
library(sf)
library(spatialreg)
library(spdep)
library(spgwr)
library(dplyr)
library(r5r)
library(rJava)
# storing the API key in system environment to be easily used in API calls
options(cancensus.api_key = "CensusMapper_ff4c917e80df34b71900e0a048c999dd")
# assigning a persistent local cache
options(cancensus.cache_path = "/Users/dainadeangelis/Desktop/4GA3Project-/Project data")
# returning census data and geography for the Vancouver CMA as an sf-class dataframe
census_data <- get_census(dataset='CA21', regions=list(CMA="59933"), vectors=c("v_CA21_1","v_CA21_386","v_CA21_906","v_CA21_4238","v_CA21_4239", "v_CA21_4240", "v_CA21_4875", "v_CA21_4914"), labels="detailed", geo_format="sf", level='CT')
# replacing spaces for variable names with periods
colnames(census_data) =  gsub(colnames(census_data),pattern="\\s|[[:punct:]]",replacement = ".")
# obtaining centroids for census tracts in the Vancouver CMA
CT_centroids <- st_coordinates(st_centroid(census_data))
#converting centroids to data frame
centroids_df <- as.data.frame(CT_centroids)
class(centroids_df)
centroids_df<- cbind(centroids_df, census_data$GeoUID)
centroids_df <- centroids_df %>%
rename("lat" = "X",
"lon" = "Y",
"id" = "census_data$GeoUID")
# example
census_data <- census_data %>%
mutate(Proportion.visible.minority = (v.CA21.4875..Total.visible.minority.population / v.CA21.1..Population..2021))
# example
minority_prop_map <- ggplot(census_data) +
geom_sf(aes(fill = cut_number(Proportion.visible.minority, 5)),
color = "black",
size = 0.1) +
scale_fill_brewer(palette = "YlOrRd") +
labs(fill = "Prop Visible Minority Vancouver CTs")
minority_prop_map
# reading csv packages
parks <- read.csv(file = "Project data/parks.csv", head = TRUE, sep = ";")
street_trees <- read.csv(file = "Project data/street-trees.csv", head = TRUE, sep = ";")
knitr::opts_chunk$set(echo = TRUE)
summary(cars)
plot(pressure)
# loading packages
library(cancensus)
library(ggplot2)
library(tidyverse)
library(tidycensus)
library(tigris)
library(kableExtra)
library(plotly)
library(sf)
library(spatialreg)
library(spdep)
library(spgwr)
library(dplyr)
library(r5r)
library(rJava)
# storing the API key in system environment to be easily used in API calls
options(cancensus.api_key = "CensusMapper_ff4c917e80df34b71900e0a048c999dd")
# assigning a persistent local cache
options(cancensus.cache_path = "/Users/dainadeangelis/Desktop/4GA3Project-/Project data")
# returning census data and geography for the Vancouver CMA as an sf-class dataframe
census_data <- get_census(dataset='CA21', regions=list(CMA="59933"), vectors=c("v_CA21_1","v_CA21_386","v_CA21_906","v_CA21_4238","v_CA21_4239", "v_CA21_4240", "v_CA21_4875", "v_CA21_4914"), labels="detailed", geo_format="sf", level='CT')
# replacing spaces for variable names with periods
colnames(census_data) =  gsub(colnames(census_data),pattern="\\s|[[:punct:]]",replacement = ".")
# obtaining centroids for census tracts in the Vancouver CMA
CT_centroids <- st_coordinates(st_centroid(census_data))
#converting centroids to data frame
centroids_df <- as.data.frame(CT_centroids)
class(centroids_df)
centroids_df<- cbind(centroids_df, census_data$GeoUID)
centroids_df <- centroids_df %>%
rename("lat" = "X",
"lon" = "Y",
"id" = "census_data$GeoUID")
# example
census_data <- census_data %>%
mutate(Proportion.visible.minority = (v.CA21.4875..Total.visible.minority.population / v.CA21.1..Population..2021))
# example
minority_prop_map <- ggplot(census_data) +
geom_sf(aes(fill = cut_number(Proportion.visible.minority, 5)),
color = "black",
size = 0.1) +
scale_fill_brewer(palette = "YlOrRd") +
labs(fill = "Prop Visible Minority Vancouver CTs")
minority_prop_map
# reading csv packages
parks <- read.csv(file = "Project data/parks.csv", head = TRUE, sep = ";")
street_trees <- read.csv(file = "Project data/street-trees.csv", head = TRUE, sep = ";")
homeless_shelters <- read.csv(file = "Project data/homeless-shelter-locations.csv", head = TRUE, sep = ";")
#extracting point data from homeless shelter csv file
homeless_shelt_coord <- data.frame(do.call("rbind", strsplit(as.character(homeless_shelters$geo_point_2d), ",", fixed = TRUE)))
# Rename multiple columns
homeless_shelt_coord <- homeless_shelt_coord %>%
rename("X" = "X1",
"Y" = "X2")
#extracting point data from park csv file
parks_coord <- data.frame(do.call("rbind", strsplit(as.character(parks$GoogleMapDest), ",", fixed = TRUE)))
# Rename multiple columns
parks_coord <- parks_coord %>%
rename("X" = "X1",
"Y" = "X2")
#preparing park data for r5r
class(parks_coord)
parks_coord<- cbind(parks_coord, parks$ParkID)
parks_coord <- parks_coord %>%
rename("lat" = "X",
"lon" = "Y",
"id" = "parks$ParkID")
parks_coord$lon <- as.numeric(parks_coord$lon)
#extracting point data from trees csv files
trees_coord <- data.frame(do.call("rbind", strsplit(as.character(street_trees$geo_point_2d), ",", fixed = TRUE)))
# Rename multiple columns
trees_coord <- trees_coord %>%
rename("X" = "X1",
"Y" = "X2")
#allocating RAM memory to Java to use the r5r package
options(java.parameters = "-Xmx2G")
#building transport network for r5r
path <- file.path("Project data/r5rpath")
#building transport network for r5r
list.files(path)
r5r_core <- setup_r5(data_path = path)
#load origin points
points <- centroids_df
class(points)
#points of interest: parks
poi <- parks_coord
#departure times
departure_datetime <- as.POSIXct("13-05-2019 14:00:00",
format = "%d-%m-%Y %H:%M:%S")
access <- accessibility(r5r_core = r5r_core,
origins = points,
destinations = poi,
opportunities_colnames = c("schools", "healthcare"),
mode = c("WALK", "TRANSIT"),
departure_datetime = departure_datetime,
decay_function = "step",
cutoffs = 60
)
View(parks_coord)
knitr::opts_chunk$set(echo = TRUE)
summary(cars)
plot(pressure)
# loading packages
library(cancensus)
library(ggplot2)
library(tidyverse)
library(tidycensus)
library(tigris)
library(kableExtra)
library(plotly)
library(sf)
library(spatialreg)
library(spdep)
library(spgwr)
library(dplyr)
library(r5r)
library(rJava)
# storing the API key in system environment to be easily used in API calls
options(cancensus.api_key = "CensusMapper_ff4c917e80df34b71900e0a048c999dd")
# assigning a persistent local cache
options(cancensus.cache_path = "/Users/dainadeangelis/Desktop/4GA3Project-/Project data")
# returning census data and geography for the Vancouver CMA as an sf-class dataframe
census_data <- get_census(dataset='CA21', regions=list(CMA="59933"), vectors=c("v_CA21_1","v_CA21_386","v_CA21_906","v_CA21_4238","v_CA21_4239", "v_CA21_4240", "v_CA21_4875", "v_CA21_4914"), labels="detailed", geo_format="sf", level='CT')
# replacing spaces for variable names with periods
colnames(census_data) =  gsub(colnames(census_data),pattern="\\s|[[:punct:]]",replacement = ".")
# obtaining centroids for census tracts in the Vancouver CMA
CT_centroids <- st_coordinates(st_centroid(census_data))
#converting centroids to data frame
centroids_df <- as.data.frame(CT_centroids)
class(centroids_df)
centroids_df<- cbind(centroids_df, census_data$GeoUID)
centroids_df <- centroids_df %>%
rename("lat" = "X",
"lon" = "Y",
"id" = "census_data$GeoUID")
# example
census_data <- census_data %>%
mutate(Proportion.visible.minority = (v.CA21.4875..Total.visible.minority.population / v.CA21.1..Population..2021))
# example
minority_prop_map <- ggplot(census_data) +
geom_sf(aes(fill = cut_number(Proportion.visible.minority, 5)),
color = "black",
size = 0.1) +
scale_fill_brewer(palette = "YlOrRd") +
labs(fill = "Prop Visible Minority Vancouver CTs")
minority_prop_map
# reading csv packages
parks <- read.csv(file = "Project data/parks.csv", head = TRUE, sep = ";")
street_trees <- read.csv(file = "Project data/street-trees.csv", head = TRUE, sep = ";")
homeless_shelters <- read.csv(file = "Project data/homeless-shelter-locations.csv", head = TRUE, sep = ";")
#extracting point data from homeless shelter csv file
homeless_shelt_coord <- data.frame(do.call("rbind", strsplit(as.character(homeless_shelters$geo_point_2d), ",", fixed = TRUE)))
# Rename multiple columns
homeless_shelt_coord <- homeless_shelt_coord %>%
rename("X" = "X1",
"Y" = "X2")
#extracting point data from park csv file
parks_coord <- data.frame(do.call("rbind", strsplit(as.character(parks$GoogleMapDest), ",", fixed = TRUE)))
# Rename multiple columns
parks_coord <- parks_coord %>%
rename("X" = "X1",
"Y" = "X2")
#preparing park data for r5r
class(parks_coord)
parks_coord<- cbind(parks_coord, parks$ParkID)
# renaming columns
parks_coord <- parks_coord %>%
rename("lat" = "X",
"lon" = "Y",
"id" = "parks$ParkID")
# changing columns to numeric
parks_coord$lon <- as.numeric(parks_coord$lon)
parks_coord$lat <- as.numeric(parks_coord$lat)
#extracting point data from trees csv files
trees_coord <- data.frame(do.call("rbind", strsplit(as.character(street_trees$geo_point_2d), ",", fixed = TRUE)))
# Rename multiple columns
trees_coord <- trees_coord %>%
rename("X" = "X1",
"Y" = "X2")
#allocating RAM memory to Java to use the r5r package
options(java.parameters = "-Xmx2G")
#building transport network for r5r
path <- file.path("Project data/r5rpath")
#building transport network for r5r
list.files(path)
r5r_core <- setup_r5(data_path = path)
#load origin points
points <- centroids_df
class(points)
#points of interest: parks
poi <- parks_coord
#departure times
departure_datetime <- as.POSIXct("13-05-2019 14:00:00",
format = "%d-%m-%Y %H:%M:%S")
access <- accessibility(r5r_core = r5r_core,
origins = points,
destinations = poi,
opportunities_colnames = c("schools", "healthcare"),
mode = c("WALK", "TRANSIT"),
departure_datetime = departure_datetime,
decay_function = "step",
cutoffs = 60
)
access <- accessibility(r5r_core = r5r_core,
origins = points,
destinations = poi,
# opportunities_colnames = c("schools", "healthcare"),
mode = c("WALK", "TRANSIT"),
departure_datetime = departure_datetime,
decay_function = "step",
cutoffs = 60
)
access <- accessibility(r5r_core = r5r_core,
origins = points,
destinations = poi,
opportunities_colnames = c(),
mode = c("WALK", "TRANSIT"),
departure_datetime = departure_datetime,
decay_function = "step",
cutoffs = 60
)
access <- accessibility(r5r_core = r5r_core,
origins = points,
destinations = poi,
opportunities_colnames = c(""),
mode = c("WALK", "TRANSIT"),
departure_datetime = departure_datetime,
decay_function = "step",
cutoffs = 60
)
access <- accessibility(r5r_core = r5r_core,
origins = points,
destinations = poi,
opportunities_colnames = c("id"),
mode = c("WALK", "TRANSIT"),
departure_datetime = departure_datetime,
decay_function = "step",
cutoffs = 60
)
access <- accessibility(r5r_core = r5r_core,
origins = points,
destinations = poi,
opportunities_colnames = c("lat"),
mode = c("WALK", "TRANSIT"),
departure_datetime = departure_datetime,
decay_function = "step",
cutoffs = 60
)
head(access)
View(access)
parks_coord <- parks_coord %>%
add_column(Parks_count = 1)
access <- accessibility(r5r_core = r5r_core,
origins = points,
destinations = poi,
opportunities_colnames = c("Parks_count"),
mode = c("WALK", "TRANSIT"),
departure_datetime = departure_datetime,
decay_function = "step",
cutoffs = 60
)
#load origin points
points <- centroids_df
class(points)
#points of interest: parks
poi <- parks_coord
#departure times
departure_datetime <- as.POSIXct("13-05-2019 14:00:00",
format = "%d-%m-%Y %H:%M:%S")
access <- accessibility(r5r_core = r5r_core,
origins = points,
destinations = poi,
opportunities_colnames = c("Parks_count"),
mode = c("WALK", "TRANSIT"),
departure_datetime = departure_datetime,
decay_function = "step",
cutoffs = 60
)
head(access)
View(access)
#load origin points
points <- centroids_df
class(points)
#points of interest: parks
poi <- parks_coord
#departure times
departure_datetime <- as.POSIXct("16-02-2023 14:00:00",
format = "%d-%m-%Y %H:%M:%S")
access <- accessibility(r5r_core = r5r_core,
origins = points,
destinations = poi,
opportunities_colnames = c("Parks_count"),
mode = c("WALK", "TRANSIT"),
departure_datetime = departure_datetime,
decay_function = "step",
cutoffs = 60
)
head(access)
View(access)
access <- accessibility(r5r_core = r5r_core,
origins = points,
destinations = poi,
opportunities_colnames = c("Parks_count"),
mode = c("WALK", "TRANSIT"),
departure_datetime = departure_datetime,
decay_function = "step",
cutoffs = 5
)
head(access)
View(access)
access <- accessibility(r5r_core = r5r_core,
origins = points,
destinations = poi,
opportunities_colnames = c("Parks_count"),
mode = c("WALK", "TRANSIT"),
departure_datetime = departure_datetime,
decay_function = "step",
cutoffs = 10
)
head(access)
access <- accessibility(r5r_core = r5r_core,
origins = points,
destinations = poi,
opportunities_colnames = c("Parks_count"),
mode = c("WALK", "TRANSIT"),
departure_datetime = departure_datetime,
decay_function = "step",
cutoffs = 10)
View(access)
